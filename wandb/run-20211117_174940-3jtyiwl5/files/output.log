==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─ResNet: 1-1                            [-1, 20]                  --
|    └─Conv2d: 2-1                       [-1, 64, 256, 256]        9,408
|    └─BatchNorm2d: 2-2                  [-1, 64, 256, 256]        128
|    └─ReLU: 2-3                         [-1, 64, 256, 256]        --
|    └─MaxPool2d: 2-4                    [-1, 64, 128, 128]        --
|    └─Sequential: 2-5                   [-1, 64, 128, 128]        --
|    |    └─BasicBlock: 3-1              [-1, 64, 128, 128]        73,984
|    |    └─BasicBlock: 3-2              [-1, 64, 128, 128]        73,984
|    └─Sequential: 2-6                   [-1, 128, 64, 64]         --
|    |    └─BasicBlock: 3-3              [-1, 128, 64, 64]         230,144
|    |    └─BasicBlock: 3-4              [-1, 128, 64, 64]         295,424
|    └─Sequential: 2-7                   [-1, 256, 32, 32]         --
|    |    └─BasicBlock: 3-5              [-1, 256, 32, 32]         919,040
|    |    └─BasicBlock: 3-6              [-1, 256, 32, 32]         1,180,672
|    └─Sequential: 2-8                   [-1, 512, 16, 16]         --
|    |    └─BasicBlock: 3-7              [-1, 512, 16, 16]         3,673,088
|    |    └─BasicBlock: 3-8              [-1, 512, 16, 16]         4,720,640
|    └─AdaptiveAvgPool2d: 2-9            [-1, 512, 1, 1]           --
|    └─Sequential: 2-10                  [-1, 20]                  --
|    |    └─Linear: 3-9                  [-1, 512]                 262,656
|    |    └─BatchNorm1d: 3-10            [-1, 512]                 1,024
|    |    └─Dropout: 3-11                [-1, 512]                 --
|    |    └─Linear: 3-12                 [-1, 512]                 262,656
|    |    └─BatchNorm1d: 3-13            [-1, 512]                 1,024
|    |    └─Dropout: 3-14                [-1, 512]                 --
|    |    └─Linear: 3-15                 [-1, 20]                  10,260
==========================================================================================
Total params: 11,714,132
Trainable params: 11,714,132
Non-trainable params: 0
Total mult-adds (G): 9.41
==========================================================================================
Input size (MB): 3.00
Forward/backward pass size (MB): 184.02
Params size (MB): 44.69
Estimated Total Size (MB): 231.70
==========================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─ResNet: 1-1                            [-1, 20]                  --
|    └─Conv2d: 2-1                       [-1, 64, 256, 256]        9,408
|    └─BatchNorm2d: 2-2                  [-1, 64, 256, 256]        128
|    └─ReLU: 2-3                         [-1, 64, 256, 256]        --
|    └─MaxPool2d: 2-4                    [-1, 64, 128, 128]        --
|    └─Sequential: 2-5                   [-1, 64, 128, 128]        --
|    |    └─BasicBlock: 3-1              [-1, 64, 128, 128]        73,984
|    |    └─BasicBlock: 3-2              [-1, 64, 128, 128]        73,984
|    └─Sequential: 2-6                   [-1, 128, 64, 64]         --
|    |    └─BasicBlock: 3-3              [-1, 128, 64, 64]         230,144
|    |    └─BasicBlock: 3-4              [-1, 128, 64, 64]         295,424
|    └─Sequential: 2-7                   [-1, 256, 32, 32]         --
|    |    └─BasicBlock: 3-5              [-1, 256, 32, 32]         919,040
|    |    └─BasicBlock: 3-6              [-1, 256, 32, 32]         1,180,672
|    └─Sequential: 2-8                   [-1, 512, 16, 16]         --
|    |    └─BasicBlock: 3-7              [-1, 512, 16, 16]         3,673,088
|    |    └─BasicBlock: 3-8              [-1, 512, 16, 16]         4,720,640
|    └─AdaptiveAvgPool2d: 2-9            [-1, 512, 1, 1]           --
|    └─Sequential: 2-10                  [-1, 20]                  --
|    |    └─Linear: 3-9                  [-1, 512]                 262,656
|    |    └─BatchNorm1d: 3-10            [-1, 512]                 1,024
|    |    └─Dropout: 3-11                [-1, 512]                 --
|    |    └─Linear: 3-12                 [-1, 512]                 262,656
|    |    └─BatchNorm1d: 3-13            [-1, 512]                 1,024
|    |    └─Dropout: 3-14                [-1, 512]                 --
|    |    └─Linear: 3-15                 [-1, 20]                  10,260
==========================================================================================
Total params: 11,714,132
Trainable params: 11,714,132
Non-trainable params: 0
Total mult-adds (G): 9.41
==========================================================================================
Input size (MB): 3.00
Forward/backward pass size (MB): 184.02
Params size (MB): 44.69
Estimated Total Size (MB): 231.70
==========================================================================================
[34m[1mwandb[39m[22m: logging graph, to disable use `wandb.watch(log_graph=False)`











TRAIN LOOP E: 0: 100%|█████████████████████████████████████████| 68/68 [00:24<00:00,  2.81it/s, LOSS=1.85, ACC=0.486]

VALID LOOP E: 0:  53%|██████████████████████▏                   | 9/17 [00:02<00:01,  4.54it/s, LOSS=1.34, ACC=0.635]
VALID LOOP E: 0: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  4.07it/s, LOSS=1.33, ACC=0.639]











TRAIN LOOP E: 1: 100%|████████████████████████████████████████| 68/68 [00:23<00:00,  2.87it/s, LOSS=0.811, ACC=0.776]

VALID LOOP E: 1:  41%|█████████████████▎                        | 7/17 [00:02<00:02,  4.13it/s, LOSS=1.15, ACC=0.699]

VALID LOOP E: 1: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  3.95it/s, LOSS=1.14, ACC=0.697]











TRAIN LOOP E: 2: 100%|████████████████████████████████████████| 68/68 [00:23<00:00,  2.89it/s, LOSS=0.472, ACC=0.879]

VALID LOOP E: 2:  88%|████████████████████████████████████▏    | 15/17 [00:03<00:00,  5.24it/s, LOSS=1.07, ACC=0.725]
VALID LOOP E: 2: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  4.00it/s, LOSS=1.07, ACC=0.725]










TRAIN LOOP E: 3: 100%|████████████████████████████████████████| 68/68 [00:23<00:00,  2.95it/s, LOSS=0.263, ACC=0.944]


VALID LOOP E: 3: 100%|██████████████████████████████████████████| 17/17 [00:04<00:00,  4.04it/s, LOSS=1.04, ACC=0.71]











TRAIN LOOP E: 4: 100%|████████████████████████████████████████| 68/68 [00:25<00:00,  2.71it/s, LOSS=0.136, ACC=0.976]


VALID LOOP E: 4: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  5.42it/s, LOSS=1.05, ACC=0.731]
VALID LOOP E: 4: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  3.66it/s, LOSS=1.05, ACC=0.731]











TRAIN LOOP E: 5: 100%|███████████████████████████████████████| 68/68 [00:24<00:00,  2.81it/s, LOSS=0.0736, ACC=0.992]

VALID LOOP E: 5:  53%|█████████████████████▋                   | 9/17 [00:02<00:02,  3.80it/s, LOSS=0.997, ACC=0.748]
VALID LOOP E: 5: 100%|█████████████████████████████████████████████| 17/17 [00:04<00:00,  3.99it/s, LOSS=1, ACC=0.75]











TRAIN LOOP E: 6: 100%|███████████████████████████████████████| 68/68 [00:23<00:00,  2.92it/s, LOSS=0.0426, ACC=0.997]

VALID LOOP E: 6: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  3.93it/s, LOSS=1.01, ACC=0.749]











TRAIN LOOP E: 7: 100%|███████████████████████████████████████| 68/68 [00:23<00:00,  2.88it/s, LOSS=0.0275, ACC=0.998]


VALID LOOP E: 7: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  3.93it/s, LOSS=1.01, ACC=0.741]










TRAIN LOOP E: 8: 100%|███████████████████████████████████████| 68/68 [00:23<00:00,  2.92it/s, LOSS=0.0218, ACC=0.999]


VALID LOOP E: 8: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  3.90it/s, LOSS=1.03, ACC=0.745]










TRAIN LOOP E: 9: 100%|███████████████████████████████████████████| 68/68 [00:23<00:00,  2.86it/s, LOSS=0.0148, ACC=1]


VALID LOOP E: 9: 100%|██████████████████████████████████████████| 17/17 [00:04<00:00,  4.03it/s, LOSS=1.02, ACC=0.75]











TRAIN LOOP E: 10: 100%|██████████████████████████████████████████| 68/68 [00:23<00:00,  2.87it/s, LOSS=0.0108, ACC=1]

VALID LOOP E: 10:  65%|███████████████████████████▊               | 11/17 [00:03<00:01,  4.55it/s, LOSS=1, ACC=0.746]
VALID LOOP E: 10: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.88it/s, LOSS=1.02, ACC=0.751]











TRAIN LOOP E: 11: 100%|█████████████████████████████████████████| 68/68 [00:22<00:00,  2.96it/s, LOSS=0.00871, ACC=1]

VALID LOOP E: 11:  94%|█████████████████████████████████████▋  | 16/17 [00:03<00:00,  6.31it/s, LOSS=1.04, ACC=0.753]
VALID LOOP E: 11: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  4.03it/s, LOSS=1.01, ACC=0.76]











TRAIN LOOP E: 12: 100%|█████████████████████████████████████████| 68/68 [00:23<00:00,  2.95it/s, LOSS=0.00744, ACC=1]

VALID LOOP E: 12: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.96it/s, LOSS=1.03, ACC=0.757]











TRAIN LOOP E: 13: 100%|█████████████████████████████████████████| 68/68 [00:23<00:00,  2.89it/s, LOSS=0.00631, ACC=1]

VALID LOOP E: 13: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.91it/s, LOSS=1.02, ACC=0.756]











TRAIN LOOP E: 14: 100%|█████████████████████████████████████████| 68/68 [00:23<00:00,  2.84it/s, LOSS=0.00551, ACC=1]

VALID LOOP E: 14: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  4.12it/s, LOSS=1.02, ACC=0.756]











TRAIN LOOP E: 15: 100%|█████████████████████████████████████████| 68/68 [00:24<00:00,  2.81it/s, LOSS=0.00511, ACC=1]


VALID LOOP E: 15: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.88it/s, LOSS=1.06, ACC=0.752]











TRAIN LOOP E: 16: 100%|█████████████████████████████████████████| 68/68 [00:24<00:00,  2.78it/s, LOSS=0.00481, ACC=1]

VALID LOOP E: 16: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.96it/s, LOSS=1.03, ACC=0.756]











TRAIN LOOP E: 17: 100%|█████████████████████████████████████████| 68/68 [00:24<00:00,  2.78it/s, LOSS=0.00441, ACC=1]


VALID LOOP E: 17: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.93it/s, LOSS=1.04, ACC=0.753]











TRAIN LOOP E: 18: 100%|█████████████████████████████████████████| 68/68 [00:24<00:00,  2.83it/s, LOSS=0.00341, ACC=1]

VALID LOOP E: 18: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.83it/s, LOSS=1.03, ACC=0.755]











TRAIN LOOP E: 19: 100%|█████████████████████████████████████████| 68/68 [00:23<00:00,  2.92it/s, LOSS=0.00322, ACC=1]

VALID LOOP E: 19: 100%|█████████████████████████████████████████| 17/17 [00:04<00:00,  3.84it/s, LOSS=1.04, ACC=0.76]











TRAIN LOOP E: 20: 100%|█████████████████████████████████████████| 68/68 [00:23<00:00,  2.87it/s, LOSS=0.00281, ACC=1]

VALID LOOP E: 20: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.96it/s, LOSS=1.03, ACC=0.763]
  0%|                                                                                         | 0/68 [00:00<?, ?it/s]












TRAIN LOOP E: 21: 100%|█████████████████████████████████████████| 68/68 [00:23<00:00,  2.84it/s, LOSS=0.00269, ACC=1]

VALID LOOP E: 21:  88%|███████████████████████████████████▎    | 15/17 [00:03<00:00,  5.45it/s, LOSS=1.04, ACC=0.759]
VALID LOOP E: 21: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  4.09it/s, LOSS=1.02, ACC=0.765]











TRAIN LOOP E: 22: 100%|█████████████████████████████████████████| 68/68 [00:23<00:00,  2.90it/s, LOSS=0.00238, ACC=1]

VALID LOOP E: 22: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.96it/s, LOSS=1.03, ACC=0.759]










TRAIN LOOP E: 23: 100%|█████████████████████████████████████████| 68/68 [00:22<00:00,  2.96it/s, LOSS=0.00208, ACC=1]


VALID LOOP E: 23: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  4.08it/s, LOSS=1.04, ACC=0.762]










TRAIN LOOP E: 24: 100%|█████████████████████████████████████████| 68/68 [00:23<00:00,  2.92it/s, LOSS=0.00194, ACC=1]


VALID LOOP E: 24: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  4.08it/s, LOSS=1.04, ACC=0.764]











TRAIN LOOP E: 25: 100%|█████████████████████████████████████████| 68/68 [00:24<00:00,  2.76it/s, LOSS=0.00189, ACC=1]

VALID LOOP E: 25: 100%|████████████████████████████████████████| 17/17 [00:04<00:00,  3.89it/s, LOSS=1.05, ACC=0.758]

TRAIN LOOP E: 26:   6%|██▍                                       | 4/68 [00:02<00:46,  1.37it/s, LOSS=0.00204, ACC=1]
Traceback (most recent call last):
  File "train.py", line 93, in <module>
    loss.backward()
  File "/home/hazemahmed/anaconda3/envs/torch_env/lib/python3.7/site-packages/torch/_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/hazemahmed/anaconda3/envs/torch_env/lib/python3.7/site-packages/torch/autograd/__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt